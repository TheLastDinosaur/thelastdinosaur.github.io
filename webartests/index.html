<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- //Get AFRAME -->
            <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
            <script src="./spritesheet-animator.js"></script>
            <!-- <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v3.13.1/dist/aframe-extras.min.js"></script> -->
            <!-- <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.1/dist/aframe-extras.min.js"></script> -->

  <!-- <script src="https://unpkg.com/aframe-aabb-collider-component@3.1.0/dist/aframe-aabb-collider-component.min.js"></script> -->

  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script> 
  
  <script>
                AFRAME.registerComponent('rotato', {

                tick: function()
                    {
                    this.el.object3D.position.x -= 0.028049;	
                    }
                });
            </script>

<script>
    AFRAME.registerComponent('foo', {
      init: function() {
        console.log("HELLO");
        this.el.addEventListener('body-loaded', function(e) {
          console.log('Player has collided with ', e.detail.body.el);
        });
      }
    })
  </script>
    <title>Document</title>
</head>
<body>
    
    <a-scene physics="debug: true">
        <a-sky color="skyblue"></a-sky>
        <a-assets>
            <img id="character" src="./walking_sprite.png">
            <img id="steps" src="./steps.png">
            <img id="cup" src="./cup.png">
            <img id="rock" src="./fallingrock.png">
            <img id="cloudy" src="./cloudy.png">

            <img id="text1" src="./opendoors.png">
            <img id="text2" src="./infintereality.png">
            <img id="textfinal" src="./daredoyou.png">

          </a-assets>
        
          <!-- Basic plane. -->
          <!-- <a-plane color="#CCC" height="20" width="20"></a-plane> -->
        
          <!-- Textured plane parallel to ground. -->
          <a-entity id="content-holder" position="0 0 -5" scale="2.5 2.5 2.5">
<!-- 
            <a-entity id="moving-ground" position="0 -1.05 0" animation="property: position; to: -2.17 -2 0; dur: 5000; easing: linear; loop: true">
                <a-plane width="2" height="2" material="shader: flat; src: #steps; transparent: true;" position="3.93 1.64 -0.1" ></a-plane>
                <a-plane width="2" height="2" material="shader: flat; src: #steps; transparent: true;" position="1.98 0.8 -0.1" ></a-plane>
                <a-plane width="2" height="2" material="shader: flat; src: #steps; transparent: true;" ></a-plane>
    
            </a-entity> -->

            <!-- skybg -->
            <a-plane width="2.05" height="1.15" color="#656868"  position="0.18 -0.11 -0.05"></a-plane>            
            <!-- Moving Clouds -->
            <a-plane width="0.15" height="0.15" material="shader: flat; src: #cloudy; transparent: true; " position="2 0.2 0" animation="property: position; to: -2 0.2 0; dur: 20000; easing: linear; loop: true"></a-plane>

            <!-- Text Boxes -->
            <a-entity id="texts" position="-0.2 -0.8 0" animation="property: position; to: -0.2 1.6 0; dur: 10000; easing: linear; loop: false">
                <a-plane material="shader: flat; src: #text1; transparent: true; " width="1" height="0.5" position="0 0 0"></a-plane>
                <a-plane material="shader: flat; src: #text2; transparent: true; " width="1" height="0.5" position="0 -0.8 0"></a-plane>
                <a-plane material="shader: flat; src: #textfinal; transparent: true; " width="1" height="0.5" position="0 -1.6 0"></a-plane>

            </a-entity>
            <a-plane width="0.15" height="0.15" material="shader: flat; src: #cloudy; transparent: true; " position="2 0.1 0" animation="property: position; to: -2 0.1 0; dur: 35000; easing: linear; loop: true"></a-plane>
            <a-plane width="0.15" height="0.15" material="shader: flat; src: #cloudy; transparent: true; " position="2 0.3 0" animation="property: position; to: -2 0.3 0; dur: 12000; easing: linear; loop: true"></a-plane>





            <a-plane width="2" height="1.1" material="shader: flat; src: #steps; transparent: true;" spritesheet-animation="rows: 4; columns: 6; frameDuration: 0.01; loop: true; play:true" position="0.18 -0.11 -0.0"></a-plane>

            <!-- collectible -->
            <a-plane static-body width="0.25" height="0.25" material="shader: flat; src: #cup; transparent: true;" spritesheet-animation="rows: 1; columns: 3; frameDuration: 0.1; loop: true;" position="2 1 0" animation="property: position; to: -2 -1 0; dur: 5000; easing: linear; loop: true"></a-plane>

            <!-- obstacle -->
            <a-plane static-body  id="obstacle" width="0.45" height="0.45" material="shader: flat; src: #rock; color:black; transparent: true;" spritesheet-animation="rows: 2; columns: 6; frameDuration: 0.1; loop: true;" position="2 0.6 0" animation="property: position; to: -2 -1 0; dur: 13000; easing: linear; loop: true"></a-plane>
            <a-plane static-body  id="guy" material="shader: flat; src: #character; transparent: true; " spritesheet-animation="rows: 4; columns: 12; frameDuration: 0.02; loop: true; play: true;"  height="0.6" width="0.3" rotation="0 0 0" position="0 0 0"></a-plane>



          </a-entity>
    </a-scene>
    

    <script>
        var myCanvas = document.getElementsByTagName('canvas');
        console.log(myCanvas[0]);
        myCanvas[0].addEventListener('click', function(){
            console.log("HEY")
            var targetEl = document.querySelector('#guy');
            
            targetEl.setAttribute("animation__first", {'property': 'position', 'to': '0 1.2 0', "dur": "350", "dir": "alternate", "loop":true});
            animation__second="property: rotation; to: 0 360 0; dur: 500; startEvents: animationcomplete__first" 
            // targetEl.setAttribute("animation__second", {'property': 'position', 'to': '0 0 0', "dur": "1000", "startEvents": "animationcomplete__first"});

            setTimeout(()=>{
                targetEl.removeAttribute("animation__first");
                targetEl.removeAttribute("animation__second");
                targetEl.setAttribute("position","0 0 0");
            },700)

            // window.alert("DA");
        })
        var targetEl = document.querySelector('#guy');
        targetEl.addEventListener('click', function() {
        targetEl.setAttribute('material', {color: 'red'});
});





var playerEl = document.querySelector('#guy');
playerEl.addEventListener('collide', function (e) {
  console.log('Player has collided with body #' + e.detail.body.id);

  e.detail.target.el;  // Original entity (playerEl).
  e.detail.body.el;    // Other entity, which playerEl touched.
  e.detail.contact;    // Stats about the collision (CANNON.ContactEquation).
  e.detail.contact.ni; // Normal (direction) of the collision (CANNON.Vec3).
});
    </script>
</body>
</html>